<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>EMS Dashboard</title>
</head>
<body class="bg-slate-900 text-white p-8">
    <h1 class="text-2xl font-black text-red-500 mb-6">RESCUELINK DISPATCH</h1>
    
    <div id="emergencyList" class="grid gap-4">
        <p id="noData" class="text-slate-500 italic">Waiting for incoming signals...</p>
    </div>

    <div class="mt-20 p-4 border border-slate-700 rounded text-xs text-slate-500 font-mono">
        DEBUGGER: <span id="debugStatus">Scanning storage...</span>
    </div>

    <script>
        function checkAlerts() {
            const rawData = localStorage.getItem('latestSOS');
            const debug = document.getElementById('debugStatus');
            
            if (!rawData) {
                debug.innerText = "Storage is EMPTY. Go to index.html and click Confirm.";
                return;
            }

            debug.innerText = "DATA FOUND! Updating display...";
            const sos = JSON.parse(rawData);
            const list = document.getElementById('emergencyList');
            document.getElementById('noData').classList.add('hidden');
            
            list.innerHTML = `
                <div class="bg-slate-800 border-l-8 border-red-600 p-6 rounded-xl shadow-2xl">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-red-500">${sos.type}</h3>
                        <span class="text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded">URGENT</span>
                    </div>
                    <p class="text-lg"><strong>Patient:</strong> ${sos.name}</p>
                    <p class="text-green-400 font-mono text-sm mt-2">üìç ${sos.lat}, ${sos.lon}</p>
                    <div class="mt-4 pt-4 border-t border-slate-700 flex gap-2">
                        <button class="bg-blue-600 px-4 py-2 rounded font-bold text-sm">View Map</button>
                        <button onclick="localStorage.clear(); location.reload();" class="bg-slate-700 px-4 py-2 rounded font-bold text-sm">Clear Alert</button>
                    </div>
                </div>
            `;
        }
        // Check every 1 second
        setInterval(checkAlerts, 1000);
    </script>
</body>
</html>
